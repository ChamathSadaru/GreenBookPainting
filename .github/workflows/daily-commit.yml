name: Daily Auto Commit

on:
  schedule:
    # හැමදාම UTC වෙලාවෙන් 00:00 ට ක්‍රියාත්මක වේ
    # (මෙය ලංකාවේ වෙලාවෙන් උදේ 5:30 ට පමණ වේ)
    - cron: '0 0 * * *'
  
  # Actions tab එකෙන් අතින් (manually) run කිරීමටත් ඉඩ දීම
  workflow_dispatch:

jobs:
  auto-commit-job:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Repository එක checkout කිරීම
        # මේකෙන් ඔයාගේ code එක workflow එකට අරගන්නවා
        uses: actions/checkout@v4

      - name: Git User සකස් කිරීම
        # commit කරන කෙනා කවුද කියලා Git වලට කියන්න ඕනේ
        run: |
          git config --global user.name "ChamathSadaru" # <--- ඔබේ GitHub නම මෙතන දාන්න
          git config --global user.email "chamathsandaru.se@gmail.com" # <--- ඔබේ GitHub email එක මෙතන දාන්න

      - name: Commit කිරීමට file එකක් update කිරීම
        run: |
          # Git commit එකක් දාන්න නම් මොකක්හරි file එකක වෙනසක් වෙන්නම ඕනේ.
          # මේ command එකෙන් 'last-update.txt' file එකට දවසේ date එක දානවා.
          echo "Last automated update: $(date)" > last-update.txt

      - name: වෙනස්කම් Commit කර Push කිරීම
        run: |
          git add last-update.txt
          # file එකේ ඇත්තටම වෙනසක් වෙලා තියෙනවද කියලා බලලා commit කරනවා
          git diff-index --quiet HEAD || git commit -m "CHORE: Daily automatic update"
          git push
